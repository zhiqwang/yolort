{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Deploying yolort on TVM\n",
    "\n",
    "This article is an introductory tutorial to deploy PyTorch YOLOv5 models with Relay VM.\n",
    "\n",
    "For us to begin with, PyTorch should be installed.\n",
    "TorchVision is also required since we will be using it as our model zoo.\n",
    "\n",
    "A quick solution is to install via pip\n",
    "\n",
    "\n",
    "```shell\n",
    "pip install torch==1.10.1\n",
    "pip install torchvision==0.11.2\n",
    "```\n",
    "\n",
    "or please refer to official site\n",
    "https://pytorch.org/get-started/locally/\n",
    "\n",
    "PyTorch versions should be backwards compatible but should be used\n",
    "with the proper TorchVision version.\n",
    "\n",
    "Currently, Only test `TVM` with PyTorch 1.7.x and 1.10.x, other versions may be unstable.\n",
    "\n",
    "And this notebook is running on macOS M1.\n",
    "\n",
    "---\n",
    "\n",
    "Copyright Â© Most of the codes is copied from the [TVM tutorial](https://tvm.apache.org/docs/tutorials/frontend/deploy_object_detection_pytorch.html#sphx-glr-tutorials-frontend-deploy-object-detection-pytorch-py)."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": false,
    "jupyter": {
     "outputs_hidden": false
    }
   },
   "outputs": [],
   "source": [
    "import tvm\n",
    "from tvm import relay\n",
    "from tvm.runtime.vm import VirtualMachine\n",
    "\n",
    "import numpy as np\n",
    "import cv2\n",
    "\n",
    "# PyTorch imports\n",
    "import torch\n",
    "from torch import nn\n",
    "import torchvision"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Load pre-trained `yolov5n` from yolort and do tracing"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "in_size = 640\n",
    "input_shape = (in_size, in_size)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [],
   "source": [
    "from yolort.models import yolov5n\n",
    "from yolort.relay import get_trace_module"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.loaded_optimizer_states_dict` property is deprecated in v1.4 and will be removed in v1.6.\n",
      "  if hasattr(mod, name):\n",
      "/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.model_size` property was deprecated in v1.5 and will be removed in v1.7. Please use the `pytorch_lightning.utilities.memory.get_model_size_mb`.\n",
      "  if hasattr(mod, name):\n",
      "/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:669: LightningDeprecationWarning: The `LightningModule.model_size` property was deprecated in v1.5 and will be removed in v1.7. Please use the `pytorch_lightning.utilities.memory.get_model_size_mb`.\n",
      "  item = getattr(mod, name)\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/yolo_module.py:113: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).\n",
      "  for img in inputs:\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/transform.py:179: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).\n",
      "  images = [img for img in images]\n",
      "/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/nn/functional.py:3701: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).\n",
      "  (torch.floor((input.size(i + 2).float() * torch.tensor(scale_factors[i], dtype=torch.float32)).float()))\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/transform.py:282: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).\n",
      "  img_h, img_w = _get_shape_onnx(img)\n",
      "/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2157.)\n",
      "  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/anchor_utils.py:45: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.\n",
      "  anchors = torch.as_tensor(self.anchor_grids, dtype=torch.float32, device=device).to(dtype=dtype)\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/anchor_utils.py:46: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.\n",
      "  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/box_head.py:402: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.\n",
      "  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)\n",
      "/Users/zhiqiang/Coding/yolort/yolort/models/box_head.py:333: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).\n",
      "  for head_output, grid, shift, stride in zip(head_outputs, grids, shifts, strides):\n"
     ]
    }
   ],
   "source": [
    "model_func = yolov5n(pretrained=True, size=(in_size, in_size))\n",
    "script_module = get_trace_module(model_func, input_shape=input_shape)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "graph(%self.1 : __torch__.yolort.relay.trace_wrapper.TraceWrapper,\n",
       "      %x : Float(1, 3, 640, 640, strides=[1228800, 409600, 640, 1], requires_grad=0, device=cpu)):\n",
       "  %model : __torch__.yolort.models.yolo_module.YOLOv5 = prim::GetAttr[name=\"model\"](%self.1)\n",
       "  %4973 : (Tensor, Tensor, Tensor) = prim::CallMethod[name=\"forward\"](%model, %x)\n",
       "  %4970 : Float(0, 4, strides=[4, 1], requires_grad=0, device=cpu), %4971 : Float(0, strides=[1], requires_grad=0, device=cpu), %4972 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::TupleUnpack(%4973)\n",
       "  %3751 : (Float(0, 4, strides=[4, 1], requires_grad=0, device=cpu), Float(0, strides=[1], requires_grad=0, device=cpu), Long(0, strides=[1], requires_grad=0, device=cpu)) = prim::TupleConstruct(%4970, %4971, %4972)\n",
       "  return (%3751)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "script_module.graph"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Download a test image and pre-process"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [],
   "source": [
    "from yolort.utils import get_image_from_url\n",
    "\n",
    "img_source = \"https://huggingface.co/spaces/zhiqwang/assets/resolve/main/bus.jpg\"\n",
    "# img_source = \"https://huggingface.co/spaces/zhiqwang/assets/resolve/main/zidane.jpg\"\n",
    "img = get_image_from_url(img_source)\n",
    "\n",
    "img = img.astype(\"float32\")\n",
    "img = cv2.resize(img, (in_size, in_size))\n",
    "\n",
    "img = np.transpose(img / 255.0, [2, 0, 1])\n",
    "img = np.expand_dims(img, axis=0)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Import the graph to Relay"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using reduce.cpu for min based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for minimum based on highest priority (10)\n",
      "Using injective.cpu for floor based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using reduce.cpu for min based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for minimum based on highest priority (10)\n",
      "Using injective.cpu for floor based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for ceil based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for round based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for ceil based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for round based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for ceil based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for round based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for ceil based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for round based on highest priority (10)\n"
     ]
    }
   ],
   "source": [
    "input_name = \"input0\"\n",
    "shape_list = [(input_name, (1, 3, *input_shape))]\n",
    "mod, params = relay.frontend.from_pytorch(script_module, shape_list)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Compile with Relay VM\n",
    "\n",
    "Note: Currently only CPU target is supported. For x86 target, it is\n",
    "highly recommended to build TVM with Intel MKL and Intel OpenMP to get\n",
    "best performance, due to the existence of large dense operator in\n",
    "torchvision rcnn models."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sqrt based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for negative based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for arange based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for meshgrid based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for copy based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for arange based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for meshgrid based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for copy based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for arange based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for meshgrid based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for copy based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for repeat based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for less based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for minimum based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "One or more operators have not been tuned. Please tune your model for better performance. Use DEBUG logging level to see more details.\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for image.resize2d based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using pool.cpu for nn.max_pool2d based on highest priority (10)\n",
      "Using pool.cpu for nn.max_pool2d based on highest priority (10)\n",
      "Using pool.cpu for nn.max_pool2d based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for image.resize2d based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for image.resize2d based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using transpose.generic for transpose based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for power based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using transpose.generic for transpose based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for power based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using injective.cpu for layout_transform based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using transpose.generic for transpose based on highest priority (10)\n",
      "Using injective.cpu for sigmoid based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for power based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for reshape based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for take based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for greater based on highest priority (10)\n",
      "Using argwhere.generic for argwhere based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for adv_index based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for adv_index based on highest priority (10)\n",
      "Using injective.cpu for ndarray_size based on highest priority (10)\n",
      "Using injective.cpu for equal based on highest priority (10)\n",
      "Using injective.cpu for zeros based on highest priority (10)\n",
      "Using reduce.cpu for min based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using reduce.cpu for max based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using concatenate.cpu for concatenate based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using injective.cpu for shape_of based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for arange based on highest priority (10)\n",
      "Using injective.cpu for expand_dims based on highest priority (10)\n",
      "Using nms.generic for vision.non_max_suppression based on highest priority (10)\n",
      "[12:46:54] /Users/zhiqiang/Coding/tvm/src/te/schedule/bound.cc:119: not in feed graph consumer = hybrid(hybrid_nms, 0x60000a817250)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for shape_of based on highest priority (10)\n",
      "Using injective.cpu for slice_like based on highest priority (10)\n",
      "Using injective.cpu for where based on highest priority (10)\n",
      "Using injective.cpu for greater_equal based on highest priority (10)\n",
      "Using injective.cpu for where based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for dyn.strided_slice based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for strided_slice based on highest priority (10)\n",
      "Using injective.cpu for adv_index based on highest priority (10)\n",
      "Using injective.cpu for split based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for squeeze based on highest priority (10)\n",
      "Using injective.cpu for subtract based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for stack based on highest priority (10)\n",
      "Using injective.cpu for adv_index based on highest priority (10)\n",
      "Using injective.cpu for adv_index based on highest priority (10)\n",
      "[12:46:54] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for cast based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using injective.cpu for add based on highest priority (10)\n",
      "Using injective.cpu for divide based on highest priority (10)\n",
      "Using reduce.cpu for prod based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using reduce.cpu for prod based on highest priority (10)\n",
      "Using injective.cpu for multiply based on highest priority (10)\n",
      "Using reduce.cpu for prod based on highest priority (10)\n",
      "[12:46:55] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used\n",
      "[12:46:55] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used\n"
     ]
    }
   ],
   "source": [
    "# Add \"-libs=mkl\" to get best performance on x86 target.\n",
    "# For x86 machine supports AVX512, the complete target is\n",
    "# \"llvm -mcpu=skylake-avx512 -libs=mkl\"\n",
    "target = \"llvm\"\n",
    "\n",
    "with tvm.transform.PassContext(opt_level=3):\n",
    "    vm_exec = relay.vm.compile(mod, target=target, params=params)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Inference with Relay VM"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": false,
    "jupyter": {
     "outputs_hidden": false
    }
   },
   "outputs": [],
   "source": [
    "ctx = tvm.cpu()\n",
    "vm = VirtualMachine(vm_exec, ctx)\n",
    "vm.set_input(\"main\", **{input_name: img})\n",
    "tvm_res = vm.run()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "collapsed": false,
    "jupyter": {
     "outputs_hidden": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "65.2 ms Â± 1.31 ms per loop (mean Â± std. dev. of 7 runs, 10 loops each)\n"
     ]
    }
   ],
   "source": [
    "%%timeit\n",
    "vm.set_input(\"main\", **{input_name: img})\n",
    "tvm_res = vm.run()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Get boxes with score larger than 0.6"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": false,
    "jupyter": {
     "outputs_hidden": false
    }
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Get 4 valid boxes\n"
     ]
    }
   ],
   "source": [
    "score_threshold = 0.6\n",
    "boxes = tvm_res[0].asnumpy().tolist()\n",
    "valid_boxes = []\n",
    "for i, score in enumerate(tvm_res[1].asnumpy().tolist()):\n",
    "    if score > score_threshold:\n",
    "        valid_boxes.append(boxes[i])\n",
    "    else:\n",
    "        break\n",
    "\n",
    "print(f\"Get {len(valid_boxes)} valid boxes\")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Verify the Inference Output on TVM backend"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {},
   "outputs": [],
   "source": [
    "with torch.no_grad():\n",
    "    torch_res = script_module(torch.from_numpy(img))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Exported model has been tested with TVM Runtime, and the result looks good!\n"
     ]
    }
   ],
   "source": [
    "for i in range(len(torch_res)):\n",
    "    torch.testing.assert_allclose(torch_res[i], tvm_res[i].asnumpy(), rtol=1e-4, atol=1e-4)\n",
    "\n",
    "print(\"Exported model has been tested with TVM Runtime, and the result looks good!\")"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "tvm",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.11"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
