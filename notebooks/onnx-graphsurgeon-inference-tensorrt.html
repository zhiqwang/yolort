<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Deploying yolort on TensorRT &#8212; yolort  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e7352e39" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js?v=b95ac943"></script>
    <link rel="icon" href="../_static/favicon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deploying yolort on TVM" href="export-relay-inference-tvm.html" />
    <link rel="prev" title="Deploying yolort on ONNX Runtime" href="export-onnx-inference-onnxruntime.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#notebooks/onnx-graphsurgeon-inference-tensorrt" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="yolort  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">YOLOv5 Runtime Stack</span>
          <span class="md-header-nav__topic"> Deploying yolort on TensorRT </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/zhiqwang/yolort/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">yolort  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="yolort documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="yolort documentation">YOLOv5 Runtime Stack</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/zhiqwang/yolort/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Getting Started</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Install yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="why-yolort.html" class="md-nav__link">Why yolort?</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Tutorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="inference-pytorch-export-libtorch.html" class="md-nav__link">Intuition for yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="comparison-between-yolort-vs-yolov5.html" class="md-nav__link">What is the difference between yolort and yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="how-to-align-with-ultralytics-yolov5.html" class="md-nav__link">How to align with ultralytics yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="anchor-label-assignment-visualization.html" class="md-nav__link">Visualize the anchor-target assignment</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="model-graph-visualization.html" class="md-nav__link">Visualize model graph</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Deployment</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="export-onnx-inference-onnxruntime.html" class="md-nav__link">Deploying yolort on ONNX Runtime</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Deploying yolort on TensorRT </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Deploying yolort on TensorRT</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#notebooks-onnx-graphsurgeon-inference-tensorrt--page-root" class="md-nav__link">Deploying yolort on TensorRT</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#TensorRT-Installation-Instructions" class="md-nav__link">TensorRT Installation Instructions</a>
        </li>
        <li class="md-nav__item"><a href="#Prepare-image-and-model-weights-to-test" class="md-nav__link">Prepare image and model weights to test</a>
        </li>
        <li class="md-nav__item"><a href="#Export-to-ONNX-and-TensorRT-model" class="md-nav__link">Export to ONNX and TensorRT model</a>
        </li>
        <li class="md-nav__item"><a href="#Test-the-exported-TensorRT-engine" class="md-nav__link">Test the exported TensorRT engine</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Inferencing-with-TensorRT" class="md-nav__link">Inferencing with TensorRT</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Predict-as-yolort" class="md-nav__link">Predict as yolort</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Inferencing-with-PyTorch" class="md-nav__link">Inferencing with PyTorch</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Verify-the-detection-results-between-yolort-and-TensorRT" class="md-nav__link">Verify the detection results between yolort and TensorRT</a>
        </li>
        <li class="md-nav__item"><a href="#Visualize-the-TensorRT-detections" class="md-nav__link">Visualize the TensorRT detections</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="export-relay-inference-tvm.html" class="md-nav__link">Deploying yolort on TVM</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">API Reference</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html" class="md-nav__link">yolort.models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#models-structure" class="md-nav__link">Models structure</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.YOLOv5" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">YOLOv5()</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#pre-trained-weights" class="md-nav__link">Pre-trained weights</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5n" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5n()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5n6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5n6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5s()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5s6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5s6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5m" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5m()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5m6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5m6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5l" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5l()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5ts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5ts()</span></code></a>
      
    
    </li></ul>
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html" class="md-nav__link">Modules and utils for YOLOv5</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.classes" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.classes</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.conf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.conf</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.forward" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.forward()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.iou" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.iou</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.max_det" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.max_det</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.multi_label" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.multi_label</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Bottleneck" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Bottleneck</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.BottleneckCSP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">BottleneckCSP</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.C3" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">C3</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.C3TR" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">C3TR</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Concat" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Concat</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Contract" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Contract</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Conv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Conv</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Conv.forward_fuse" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Conv.forward_fuse()</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.DWConv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DWConv</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect.onnx_dynamic" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect.onnx_dynamic</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect.stride" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect.stride</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Ensemble" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Ensemble</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Expand" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Expand</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Focus" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Focus</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.GhostBottleneck" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GhostBottleneck</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.GhostConv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GhostConv</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Model" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.SPP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SPP</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.SPPF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SPPF</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.add_yolov5_context" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">add_yolov5_context()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.attempt_download" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">attempt_download()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.focus_transform" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">focus_transform()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.get_yolov5_size" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_yolov5_size()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.intersect_dicts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">intersect_dicts()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.letterbox" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">letterbox()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.load_yolov5_model" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load_yolov5_model()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.non_max_suppression" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">non_max_suppression()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.scale_coords" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">scale_coords()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.select_device" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">select_device()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.set_logging" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">set_logging()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.space_to_depth" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">space_to_depth()</span></code></a>
      
    
    </li></ul>
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#notebooks-onnx-graphsurgeon-inference-tensorrt--page-root" class="md-nav__link">Deploying yolort on TensorRT</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#TensorRT-Installation-Instructions" class="md-nav__link">TensorRT Installation Instructions</a>
        </li>
        <li class="md-nav__item"><a href="#Prepare-image-and-model-weights-to-test" class="md-nav__link">Prepare image and model weights to test</a>
        </li>
        <li class="md-nav__item"><a href="#Export-to-ONNX-and-TensorRT-model" class="md-nav__link">Export to ONNX and TensorRT model</a>
        </li>
        <li class="md-nav__item"><a href="#Test-the-exported-TensorRT-engine" class="md-nav__link">Test the exported TensorRT engine</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Inferencing-with-TensorRT" class="md-nav__link">Inferencing with TensorRT</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Predict-as-yolort" class="md-nav__link">Predict as yolort</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Inferencing-with-PyTorch" class="md-nav__link">Inferencing with PyTorch</a>
        </li></ul>
            </nav>
        </li>
        <li class="md-nav__item"><a href="#Verify-the-detection-results-between-yolort-and-TensorRT" class="md-nav__link">Verify the detection results between yolort and TensorRT</a>
        </li>
        <li class="md-nav__item"><a href="#Visualize-the-TensorRT-detections" class="md-nav__link">Visualize the TensorRT detections</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><section id="Deploying-yolort-on-TensorRT">
<h1 id="notebooks-onnx-graphsurgeon-inference-tensorrt--page-root">Deploying yolort on TensorRT<a class="headerlink" href="#notebooks-onnx-graphsurgeon-inference-tensorrt--page-root" title="Permalink to this heading">¶</a></h1>
<p>Unlike other pipelines that deal with yolov5 on TensorRT, we embed the whole post-processing into the Graph with <code class="docutils literal notranslate"><span class="pre">onnx-graghsurgeon</span></code>. We gain a lot with this whole pipeline. The ablation experiment results are below. The first one is the result without running <code class="docutils literal notranslate"><span class="pre">EfficientNMS_TRT</span></code>, and the second one is the result with <code class="docutils literal notranslate"><span class="pre">EfficientNMS_TRT</span></code> embedded. As you can see, the inference time is even reduced, we guess it is because the data copied to the device will be much less after doing
<code class="docutils literal notranslate"><span class="pre">EfficientNMS_TRT</span></code>. (The mean Latency of D2H is reduced from <code class="docutils literal notranslate"><span class="pre">0.868048</span> <span class="pre">ms</span></code> to <code class="docutils literal notranslate"><span class="pre">0.0102295</span> <span class="pre">ms</span></code>, running on Nivdia Geforce GTX 1080ti, using TensorRT 8.2 with yolov5n6 and scaling images to <code class="docutils literal notranslate"><span class="pre">512x640</span></code>.)</p>
<p>And <code class="docutils literal notranslate"><span class="pre">onnx-graphsurgeon</span></code> is easy to install, you can just use their prebuilt wheels:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>python3 -m pip install onnx_graphsurgeon --index-url https://pypi.ngc.nvidia.com
</pre></div>
</div>
<p>The detailed results:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[I] === Performance summary w/o EfficientNMS_TRT plugin ===
[I] Throughput: 383.298 qps
[I] Latency: min = 3.66479 ms, max = 5.41199 ms, mean = 4.00543 ms, median = 3.99316 ms, percentile(99%) = 4.23831 ms
[I] End-to-End Host Latency: min = 3.76599 ms, max = 6.45874 ms, mean = 5.08597 ms, median = 5.07544 ms, percentile(99%) = 5.50839 ms
[I] Enqueue Time: min = 0.743408 ms, max = 5.27966 ms, mean = 0.940805 ms, median = 0.924805 ms, percentile(99%) = 1.37329 ms
[I] H2D Latency: min = 0.502045 ms, max = 0.62674 ms, mean = 0.538255 ms, median = 0.537354 ms, percentile(99%) = 0.582153 ms
[I] GPU Compute Time: min = 2.23233 ms, max = 3.92395 ms, mean = 2.59913 ms, median = 2.58661 ms, percentile(99%) = 2.8201 ms
[I] D2H Latency: min = 0.851807 ms, max = 0.900421 ms, mean = 0.868048 ms, median = 0.867676 ms, percentile(99%) = 0.889191 ms
[I] Total Host Walltime: 3.0081 s
[I] Total GPU Compute Time: 2.99679 s
[I] Explanations of the performance metrics are printed in the verbose logs.
[I]
&amp;&amp;&amp;&amp; PASSED TensorRT.trtexec [TensorRT v8201] # trtexec --onnx=yolov5n6-no-nms.onnx --workspace=8096
</pre></div>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>[I] === Performance summary w/ EfficientNMS_TRT plugin ===
[I] Throughput: 389.234 qps
[I] Latency: min = 2.81482 ms, max = 9.77234 ms, mean = 3.1062 ms, median = 3.07642 ms, percentile(99%) = 3.33548 ms
[I] End-to-End Host Latency: min = 2.82202 ms, max = 11.6749 ms, mean = 4.939 ms, median = 4.95587 ms, percentile(99%) = 5.45207 ms
[I] Enqueue Time: min = 0.999878 ms, max = 11.3833 ms, mean = 1.28942 ms, median = 1.18579 ms, percentile(99%) = 4.53088 ms
[I] H2D Latency: min = 0.488159 ms, max = 0.633881 ms, mean = 0.546754 ms, median = 0.546631 ms, percentile(99%) = 0.570557 ms
[I] GPU Compute Time: min = 2.30298 ms, max = 9.21094 ms, mean = 2.54921 ms, median = 2.51904 ms, percentile(99%) = 2.78528 ms
[I] D2H Latency: min = 0.00610352 ms, max = 0.302734 ms, mean = 0.0102295 ms, median = 0.00976562 ms, percentile(99%) = 0.0151367 ms
[I] Total Host Walltime: 3.00591 s
[I] Total GPU Compute Time: 2.98258 s
[I] Explanations of the performance metrics are printed in the verbose logs.
[I]
&amp;&amp;&amp;&amp; PASSED TensorRT.trtexec [TensorRT v8201] # trtexec --onnx=yolov5n6-efficient-nms.onnx --workspace=8096
</pre></div>
</div>
<section id="TensorRT-Installation-Instructions">
<h2 id="TensorRT-Installation-Instructions">TensorRT Installation Instructions<a class="headerlink" href="#TensorRT-Installation-Instructions" title="Permalink to this heading">¶</a></h2>
<p>For us to unfold the subsequent story, TensorRT should be installed and the minimal version of TensorRT to run this demo is 8.2.0. Check out the TensorRT installation guides at <a class="reference external" href="https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html">https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html</a>. You can use the Python wheels provided by TensorRT if you only want to use the Python interface:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>pip install -U nvidia-tensorrt --index-url https://pypi.ngc.nvidia.com
</pre></div>
</div>
<p>These wheels only works on Ubuntu 18.04+ or CentOS 7+ with Python versions 3.6 to 3.9 and CUDA 11.x. Check out the details at <a class="reference external" href="https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html#installing-pip">https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html#installing-pip</a>.</p>
<p>There are many ways to install the whole TensorRT at <a class="reference external" href="https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html#installing">https://docs.nvidia.com/deeplearning/tensorrt/install-guide/index.html#installing</a>. One option to use the C++ interface of TensorRT is via docker. We’ve tested the docker published by Meta (Facebook) containing the TensorRT and PyTorch at NVIDIA GPU Cloud (NGC): <a class="reference external" href="https://catalog.ngc.nvidia.com/orgs/nvidia/containers/pytorch">https://catalog.ngc.nvidia.com/orgs/nvidia/containers/pytorch</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"CUDA_DEVICE_ORDER"</span><span class="p">]</span> <span class="o">=</span> <span class="s2">"PCI_BUS_ID"</span>
<span class="n">cuda_visible</span> <span class="o">=</span> <span class="s2">"0"</span>
<span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">"CUDA_VISIBLE_DEVICES"</span><span class="p">]</span> <span class="o">=</span> <span class="n">cuda_visible</span>

<span class="k">assert</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">device</span><span class="p">(</span><span class="s1">'cuda'</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">tensorrt</span> <span class="k">as</span> <span class="nn">trt</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"We're using TensorRT: </span><span class="si">{</span><span class="n">trt</span><span class="o">.</span><span class="n">__version__</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">device</span><span class="si">}</span><span class="s2"> device: </span><span class="si">{</span><span class="n">cuda_visible</span><span class="si">}</span><span class="s2">."</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
We're using TensorRT: 8.2.4.2 on cuda device: 0.
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cv2</span>

<span class="kn">from</span> <span class="nn">yolort.utils</span> <span class="kn">import</span> <span class="n">Visualizer</span>
<span class="kn">from</span> <span class="nn">yolort.v5</span> <span class="kn">import</span> <span class="n">attempt_download</span>
<span class="kn">from</span> <span class="nn">yolort.v5.utils.downloads</span> <span class="kn">import</span> <span class="n">safe_download</span>
</pre></div>
</div>
</div>
</section>
<section id="Prepare-image-and-model-weights-to-test">
<h2 id="Prepare-image-and-model-weights-to-test">Prepare image and model weights to test<a class="headerlink" href="#Prepare-image-and-model-weights-to-test" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define some parameters</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">img_size</span> <span class="o">=</span> <span class="mi">640</span>
<span class="n">size_divisible</span> <span class="o">=</span> <span class="mi">32</span>
<span class="n">fixed_shape</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">score_thresh</span> <span class="o">=</span> <span class="mf">0.35</span>
<span class="n">nms_thresh</span> <span class="o">=</span> <span class="mf">0.45</span>
<span class="n">detections_per_img</span> <span class="o">=</span> <span class="mi">100</span>
<span class="c1"># Must upgrade TensorRT to 8.2.4 or higher to use fp16 mode.</span>
<span class="n">precision</span> <span class="o">=</span> <span class="s2">"fp16"</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># img_source = "https://huggingface.co/spaces/zhiqwang/assets/resolve/main/zidane.jpg"</span>
<span class="n">img_source</span> <span class="o">=</span> <span class="s2">"https://huggingface.co/spaces/zhiqwang/assets/resolve/main/bus.jpg"</span>
<span class="n">img_path</span> <span class="o">=</span> <span class="n">img_source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">safe_download</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">img_source</span><span class="p">)</span>
<span class="n">img_raw</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">imread</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading https://huggingface.co/spaces/zhiqwang/assets/resolve/main/bus.jpg to bus.jpg...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "df5c318386da47e39f8fc9cc04862fe5", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># yolov5s6.pt is downloaded from 'https://github.com/ultralytics/yolov5/releases/download/v6.0/yolov5n6.pt'</span>
<span class="n">model_path</span> <span class="o">=</span> <span class="s2">"yolov5s.pt"</span>

<span class="n">checkpoint_path</span> <span class="o">=</span> <span class="n">attempt_download</span><span class="p">(</span><span class="n">model_path</span><span class="p">)</span>
<span class="n">onnx_path</span> <span class="o">=</span> <span class="s2">"yolov5s.onnx"</span>
<span class="n">engine_path</span> <span class="o">=</span> <span class="s2">"yolov5s.engine"</span>
</pre></div>
</div>
</div>
</section>
<section id="Export-to-ONNX-and-TensorRT-model">
<h2 id="Export-to-ONNX-and-TensorRT-model">Export to ONNX and TensorRT model<a class="headerlink" href="#Export-to-ONNX-and-TensorRT-model" title="Permalink to this heading">¶</a></h2>
<p>We provide a utilization tool <code class="docutils literal notranslate"><span class="pre">export_tensorrt_engine</span></code> for exporting TensorRT engines.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.runtime.trt_helper</span> <span class="kn">import</span> <span class="n">export_tensorrt_engine</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_sample</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">img_size</span><span class="p">,</span> <span class="n">img_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">export_tensorrt_engine</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">score_thresh</span><span class="o">=</span><span class="n">score_thresh</span><span class="p">,</span>
    <span class="n">nms_thresh</span><span class="o">=</span><span class="n">nms_thresh</span><span class="p">,</span>
    <span class="n">onnx_path</span><span class="o">=</span><span class="n">onnx_path</span><span class="p">,</span>
    <span class="n">engine_path</span><span class="o">=</span><span class="n">engine_path</span><span class="p">,</span>
    <span class="n">input_sample</span><span class="o">=</span><span class="n">input_sample</span><span class="p">,</span>
    <span class="n">detections_per_img</span><span class="o">=</span><span class="n">detections_per_img</span><span class="p">,</span>
    <span class="n">precision</span><span class="o">=</span><span class="n">precision</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loaded saved model from yolov5s.pt
/root/miniconda3/envs/torch/lib/python3.8/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/workspace/yolo/yolort/yolort/models/anchor_utils.py:46: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  anchors = torch.as_tensor(self.anchor_grids, dtype=torch.float32, device=device).to(dtype=dtype)
/workspace/yolo/yolort/yolort/models/anchor_utils.py:47: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)
/workspace/yolo/yolort/yolort/relay/logits_decoder.py:45: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)
/workspace/yolo/yolort/yolort/models/box_head.py:337: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  for head_output, grid, shift, stride in zip(head_outputs, grids, shifts, strides):
PyTorch2ONNX graph created successfully
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[W] 'Shape tensor cast elision' routine failed with: None
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Created NMS plugin 'EfficientNMS_TRT' with attributes: {'plugin_version': '1', 'background_class': -1, 'max_output_boxes': 100, 'score_threshold': 0.35, 'iou_threshold': 0.45, 'score_activation': False, 'box_coding': 0}
Saved ONNX model to yolov5s.onnx
Network Description
Input 'images' with shape (1, 3, 640, 640) and dtype DataType.FLOAT
Output 'num_detections' with shape (1, 1) and dtype DataType.INT32
Output 'detection_boxes' with shape (1, 100, 4) and dtype DataType.FLOAT
Output 'detection_scores' with shape (1, 100) and dtype DataType.FLOAT
Output 'detection_classes' with shape (1, 100) and dtype DataType.INT32
Building fp16 Engine in yolov5s.engine
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[05/22/2022-11:13:24] [TRT] [I] [MemUsageChange] Init CUDA: CPU +457, GPU +0, now: CPU 674, GPU 354 (MiB)
[05/22/2022-11:13:24] [TRT] [I] [MemUsageSnapshot] Begin constructing builder kernel library: CPU 674 MiB, GPU 354 MiB
[05/22/2022-11:13:24] [TRT] [I] [MemUsageSnapshot] End constructing builder kernel library: CPU 828 MiB, GPU 398 MiB
[05/22/2022-11:13:24] [TRT] [I] ----------------------------------------------------------------
[05/22/2022-11:13:24] [TRT] [I] Input filename:   yolov5s.onnx
[05/22/2022-11:13:24] [TRT] [I] ONNX IR version:  0.0.8
[05/22/2022-11:13:24] [TRT] [I] Opset version:    11
[05/22/2022-11:13:24] [TRT] [I] Producer name:
[05/22/2022-11:13:24] [TRT] [I] Producer version:
[05/22/2022-11:13:24] [TRT] [I] Domain:
[05/22/2022-11:13:24] [TRT] [I] Model version:    0
[05/22/2022-11:13:24] [TRT] [I] Doc string:
[05/22/2022-11:13:24] [TRT] [I] ----------------------------------------------------------------
[05/22/2022-11:13:24] [TRT] [W] parsers/onnx/onnx2trt_utils.cpp:364: Your ONNX model has been generated with INT64 weights, while TensorRT does not natively support INT64. Attempting to cast down to INT32.
[05/22/2022-11:13:24] [TRT] [W] parsers/onnx/onnx2trt_utils.cpp:392: One or more weights outside the range of INT32 was clamped
[05/22/2022-11:13:24] [TRT] [W] parsers/onnx/onnx2trt_utils.cpp:392: One or more weights outside the range of INT32 was clamped
[05/22/2022-11:13:24] [TRT] [W] parsers/onnx/onnx2trt_utils.cpp:392: One or more weights outside the range of INT32 was clamped
[05/22/2022-11:13:24] [TRT] [W] parsers/onnx/onnx2trt_utils.cpp:392: One or more weights outside the range of INT32 was clamped
[05/22/2022-11:13:24] [TRT] [I] No importer registered for op: EfficientNMS_TRT. Attempting to import as plugin.
[05/22/2022-11:13:24] [TRT] [I] Searching for plugin: EfficientNMS_TRT, plugin_version: 1, plugin_namespace:
[05/22/2022-11:13:24] [TRT] [I] Successfully created plugin: EfficientNMS_TRT
[05/22/2022-11:13:25] [TRT] [I] [MemUsageChange] Init cuBLAS/cuBLASLt: CPU +850, GPU +368, now: CPU 1711, GPU 766 (MiB)
[05/22/2022-11:13:25] [TRT] [I] [MemUsageChange] Init cuDNN: CPU +125, GPU +58, now: CPU 1836, GPU 824 (MiB)
[05/22/2022-11:13:25] [TRT] [I] Local timing cache in use. Profiling results in this builder pass will not be stored.
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Serialize engine success, saved as yolov5s.engine
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[05/22/2022-11:17:18] [TRT] [I] Detected 1 inputs and 4 output network tensors.
[05/22/2022-11:17:18] [TRT] [I] Total Host Persistent Memory: 136048
[05/22/2022-11:17:18] [TRT] [I] Total Device Persistent Memory: 15027712
[05/22/2022-11:17:18] [TRT] [I] Total Scratch Memory: 40320768
[05/22/2022-11:17:18] [TRT] [I] [MemUsageStats] Peak memory usage of TRT CPU/GPU memory allocators: CPU 17 MiB, GPU 4371 MiB
[05/22/2022-11:17:18] [TRT] [I] [BlockAssignment] Algorithm ShiftNTopDown took 4.87204ms to assign 7 blocks to 82 nodes requiring 52404225 bytes.
[05/22/2022-11:17:18] [TRT] [I] Total Activation Memory: 52404225
[05/22/2022-11:17:18] [TRT] [I] [MemUsageChange] Init cuBLAS/cuBLASLt: CPU +0, GPU +8, now: CPU 4880, GPU 2272 (MiB)
[05/22/2022-11:17:18] [TRT] [I] [MemUsageChange] Init cuDNN: CPU +0, GPU +8, now: CPU 4880, GPU 2280 (MiB)
[05/22/2022-11:17:18] [TRT] [I] [MemUsageChange] TensorRT-managed allocation in building engine: CPU +14, GPU +15, now: CPU 14, GPU 15 (MiB)
</pre></div></div>
</div>
</section>
<section id="Test-the-exported-TensorRT-engine">
<h2 id="Test-the-exported-TensorRT-engine">Test the exported TensorRT engine<a class="headerlink" href="#Test-the-exported-TensorRT-engine" title="Permalink to this heading">¶</a></h2>
<p>Actually the above exported TensorRT engine only contains the post-processing (<code class="docutils literal notranslate"><span class="pre">nms</span></code>). And we wrap the pre-processing named <code class="docutils literal notranslate"><span class="pre">YOLOTransform</span></code> into a new module <code class="docutils literal notranslate"><span class="pre">PredictorTRT</span></code> for easy of use.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.runtime</span> <span class="kn">import</span> <span class="n">PredictorTRT</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_runtime</span> <span class="o">=</span> <span class="n">PredictorTRT</span><span class="p">(</span><span class="n">engine_path</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Loading yolov5s.engine for TensorRT inference...
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[05/22/2022-11:18:38] [TRT] [I] [MemUsageChange] Init CUDA: CPU +457, GPU +0, now: CPU 550, GPU 354 (MiB)
[05/22/2022-11:18:38] [TRT] [I] Loaded engine size: 17 MiB
[05/22/2022-11:18:39] [TRT] [I] [MemUsageChange] Init cuBLAS/cuBLASLt: CPU +850, GPU +368, now: CPU 1426, GPU 740 (MiB)
[05/22/2022-11:18:39] [TRT] [I] [MemUsageChange] Init cuDNN: CPU +126, GPU +58, now: CPU 1552, GPU 798 (MiB)
[05/22/2022-11:18:39] [TRT] [I] [MemUsageChange] TensorRT-managed allocation in engine deserialization: CPU +0, GPU +14, now: CPU 0, GPU 14 (MiB)
[05/22/2022-11:18:40] [TRT] [I] [MemUsageChange] Init cuBLAS/cuBLASLt: CPU +0, GPU +10, now: CPU 3366, GPU 1696 (MiB)
[05/22/2022-11:18:40] [TRT] [I] [MemUsageChange] Init cuDNN: CPU +1, GPU +8, now: CPU 3367, GPU 1704 (MiB)
[05/22/2022-11:18:40] [TRT] [I] [MemUsageChange] TensorRT-managed allocation in IExecutionContext creation: CPU +0, GPU +64, now: CPU 0, GPU 78 (MiB)
</pre></div></div>
</div>
<p>Let’s warmup the engine by running inference once for GPU device.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_runtime</span><span class="o">.</span><span class="n">warmup</span><span class="p">()</span>
</pre></div>
</div>
</div>
<section id="Inferencing-with-TensorRT">
<h3 id="Inferencing-with-TensorRT">Inferencing with TensorRT<a class="headerlink" href="#Inferencing-with-TensorRT" title="Permalink to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">predictions_trt</span> <span class="o">=</span> <span class="n">y_runtime</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
9.34 ms ± 145 µs per loop (mean ± std. dev. of 7 runs, 100 loops each)
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_trt</span> <span class="o">=</span> <span class="n">y_runtime</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_trt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{'scores': tensor([0.83350, 0.82812, 0.78564, 0.77734, 0.46313], device='cuda:0'),
  'labels': tensor([0, 0, 0, 5, 0], device='cuda:0', dtype=torch.int32),
  'boxes': tensor([[220.85156, 407.53125, 345.51562, 874.96875],
          [662.34375, 386.64844, 810.84375, 880.87500],
          [ 57.58594, 396.98438, 214.94531, 918.00000],
          [ 14.55469, 221.69531, 799.03125, 784.68750],
          [ -0.94922, 553.50000,  72.45703, 874.96875]], device='cuda:0')}]
</pre></div></div>
</div>
</section>
</section>
<section id="Predict-as-yolort">
<h2 id="Predict-as-yolort">Predict as yolort<a class="headerlink" href="#Predict-as-yolort" title="Permalink to this heading">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.models</span> <span class="kn">import</span> <span class="n">YOLOv5</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">YOLOv5</span><span class="o">.</span><span class="n">load_from_yolov5</span><span class="p">(</span>
    <span class="n">model_path</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">img_size</span><span class="p">),</span>
    <span class="n">size_divisible</span><span class="o">=</span><span class="n">size_divisible</span><span class="p">,</span>
    <span class="n">fixed_shape</span><span class="o">=</span><span class="p">(</span><span class="n">img_size</span><span class="p">,</span> <span class="n">img_size</span><span class="p">),</span>
    <span class="n">score_thresh</span><span class="o">=</span><span class="n">score_thresh</span><span class="p">,</span>
    <span class="n">nms_thresh</span><span class="o">=</span><span class="n">nms_thresh</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Inferencing-with-PyTorch">
<h3 id="Inferencing-with-PyTorch">Inferencing with PyTorch<a class="headerlink" href="#Inferencing-with-PyTorch" title="Permalink to this heading">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_pt</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">img_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/root/miniconda3/envs/torch/lib/python3.8/site-packages/torch/functional.py:568: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2228.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_trt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{'scores': tensor([0.83350, 0.82812, 0.78564, 0.77734, 0.46313], device='cuda:0'),
  'labels': tensor([0, 0, 0, 5, 0], device='cuda:0', dtype=torch.int32),
  'boxes': tensor([[220.85156, 407.53125, 345.51562, 874.96875],
          [662.34375, 386.64844, 810.84375, 880.87500],
          [ 57.58594, 396.98438, 214.94531, 918.00000],
          [ 14.55469, 221.69531, 799.03125, 784.68750],
          [ -0.94922, 553.50000,  72.45703, 874.96875]], device='cuda:0')}]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predictions_pt</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[{'scores': tensor([0.83449, 0.82892, 0.78632, 0.78010, 0.46298], device='cuda:0'),
  'labels': tensor([0, 0, 0, 5, 0], device='cuda:0'),
  'boxes': tensor([[220.82433, 407.41098, 345.70523, 874.90283],
          [662.59210, 386.32590, 810.79279, 880.39319],
          [ 57.56377, 397.15387, 215.05116, 918.31415],
          [ 14.63786, 221.99287, 798.34180, 784.72064],
          [ -1.00095, 553.44971,  72.44920, 874.67841]], device='cuda:0')}]
</pre></div></div>
</div>
</section>
</section>
<section id="Verify-the-detection-results-between-yolort-and-TensorRT">
<h2 id="Verify-the-detection-results-between-yolort-and-TensorRT">Verify the detection results between yolort and TensorRT<a class="headerlink" href="#Verify-the-detection-results-between-yolort-and-TensorRT" title="Permalink to this heading">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Testing boxes</span>
<span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">predictions_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"boxes"</span><span class="p">]</span> <span class="o">/</span> <span class="n">img_size</span><span class="p">,</span>
                           <span class="n">predictions_trt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"boxes"</span><span class="p">]</span> <span class="o">/</span> <span class="n">img_size</span><span class="p">,</span>
                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="c1"># Testing scores</span>
<span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">predictions_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"scores"</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                           <span class="n">predictions_trt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"scores"</span><span class="p">]</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span>
                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>
<span class="c1"># Testing labels</span>
<span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_close</span><span class="p">(</span><span class="n">predictions_pt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"labels"</span><span class="p">],</span>
                           <span class="n">predictions_trt</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">"labels"</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                           <span class="n">atol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Exported model has been tested, and the result looks good!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Exported model has been tested, and the result looks good!
</pre></div></div>
</div>
</section>
<section id="Visualize-the-TensorRT-detections">
<h2 id="Visualize-the-TensorRT-detections">Visualize the TensorRT detections<a class="headerlink" href="#Visualize-the-TensorRT-detections" title="Permalink to this heading">¶</a></h2>
<p>Get label names first.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># label_path = "https://raw.githubusercontent.com/zhiqwang/yolort/main/notebooks/assets/coco.names"</span>
<span class="n">label_source</span> <span class="o">=</span> <span class="s2">"https://huggingface.co/spaces/zhiqwang/assets/resolve/main/coco.names"</span>
<span class="n">label_path</span> <span class="o">=</span> <span class="n">label_source</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">"/"</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">safe_download</span><span class="p">(</span><span class="n">label_path</span><span class="p">,</span> <span class="n">label_source</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Downloading https://huggingface.co/spaces/zhiqwang/assets/resolve/main/coco.names to coco.names...
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "9a969e03e73b4393bbcca6bea0ff1dc1", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">v</span> <span class="o">=</span> <span class="n">Visualizer</span><span class="p">(</span><span class="n">img_raw</span><span class="p">,</span> <span class="n">metalabels</span><span class="o">=</span><span class="n">label_path</span><span class="p">)</span>
<span class="n">v</span><span class="o">.</span><span class="n">draw_instance_predictions</span><span class="p">(</span><span class="n">predictions_trt</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">v</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_onnx-graphsurgeon-inference-tensorrt_33_0.png" src="../_images/notebooks_onnx-graphsurgeon-inference-tensorrt_33_0.png"/>
</div>
</div>
</section>
</section>
<p>View this document as a notebook:
<a class="reference external" href="https://github.com/zhiqwang/yolort/blob/main/notebooks/onnx-graphsurgeon-inference-tensorrt.ipynb">https://github.com/zhiqwang/yolort/blob/main/notebooks/onnx-graphsurgeon-inference-tensorrt.ipynb</a></p>
<hr class="docutils"/>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="export-onnx-inference-onnxruntime.html" title="Deploying yolort on ONNX Runtime"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Deploying yolort on ONNX Runtime </span>
              </div>
            </a>
          
          
            <a href="export-relay-inference-tvm.html" title="Deploying yolort on TVM"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Deploying yolort on TVM </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2023, yolort team.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>