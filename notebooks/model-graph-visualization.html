<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Visualize model graph &#8212; yolort  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=e7352e39" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css?v=79c92029" />
    <link rel="stylesheet" type="text/css" href="../_static/nbsphinx-code-cells.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js?v=b95ac943"></script>
    <link rel="icon" href="../_static/favicon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Deploying yolort on ONNX Runtime" href="export-onnx-inference-onnxruntime.html" />
    <link rel="prev" title="Visualize the anchor-target assignment" href="anchor-label-assignment-visualization.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#notebooks/model-graph-visualization" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="yolort  documentation"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">YOLOv5 Runtime Stack</span>
          <span class="md-header-nav__topic"> Visualize model graph </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/zhiqwang/yolov5-rt-stack/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">yolort  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="yolort documentation" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="yolort documentation">YOLOv5 Runtime Stack</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/zhiqwang/yolov5-rt-stack/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Getting Started</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Install yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="why-yolort.html" class="md-nav__link">Why yolort?</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Tutorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="inference-pytorch-export-libtorch.html" class="md-nav__link">Intuition for yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="comparison-between-yolort-vs-yolov5.html" class="md-nav__link">What is the difference between yolort and yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="how-to-align-with-ultralytics-yolov5.html" class="md-nav__link">How to align with ultralytics yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="anchor-label-assignment-visualization.html" class="md-nav__link">Visualize the anchor-target assignment</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Visualize model graph </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Visualize model graph</a>
      
        
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Deployment</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="export-onnx-inference-onnxruntime.html" class="md-nav__link">Deploying yolort on ONNX Runtime</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="onnx-graphsurgeon-inference-tensorrt.html" class="md-nav__link">Deploying yolort on TensorRT</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="export-relay-inference-tvm.html" class="md-nav__link">Deploying yolort on TVM</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">API Reference</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html" class="md-nav__link">yolort.models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#models-structure" class="md-nav__link">Models structure</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.YOLOv5" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">YOLOv5()</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#pre-trained-weights" class="md-nav__link">Pre-trained weights</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5n" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5n()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5n6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5n6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5s" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5s()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5s6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5s6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5m" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5m()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5m6" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5m6()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5l" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5l()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#yolort.models.yolov5ts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">yolov5ts()</span></code></a>
      
    
    </li></ul>
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html" class="md-nav__link">Modules and utils for YOLOv5</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.classes" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.classes</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.conf" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.conf</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.forward" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.forward()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.iou" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.iou</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.max_det" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.max_det</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.AutoShape.multi_label" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">AutoShape.multi_label</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Bottleneck" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Bottleneck</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.BottleneckCSP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">BottleneckCSP</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.C3" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">C3</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.C3TR" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">C3TR</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Concat" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Concat</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Contract" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Contract</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Conv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Conv</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Conv.forward_fuse" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Conv.forward_fuse()</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.DWConv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">DWConv</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect</span></code></a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect.onnx_dynamic" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect.onnx_dynamic</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Detect.stride" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Detect.stride</span></code></a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Ensemble" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Ensemble</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Expand" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Expand</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Focus" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Focus</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.GhostBottleneck" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GhostBottleneck</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.GhostConv" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">GhostConv</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.Model" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.SPP" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SPP</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.SPPF" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">SPPF</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.add_yolov5_context" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">add_yolov5_context()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.attempt_download" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">attempt_download()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.focus_transform" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">focus_transform()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.get_yolov5_size" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">get_yolov5_size()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.intersect_dicts" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">intersect_dicts()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.letterbox" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">letterbox()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.load_yolov5_model" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">load_yolov5_model()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.non_max_suppression" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">non_max_suppression()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.scale_coords" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">scale_coords()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.select_device" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">select_device()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.set_logging" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">set_logging()</span></code></a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html#yolort.v5.space_to_depth" class="md-nav__link"><code class="docutils literal notranslate"><span class="pre">space_to_depth()</span></code></a>
      
    
    </li></ul>
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
  <ul class="md-nav__list" data-md-scrollfix="">
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><section id="Visualize-model-graph">
<h1 id="notebooks-model-graph-visualization--page-root">Visualize model graph<a class="headerlink" href="#notebooks-model-graph-visualization--page-root" title="Permalink to this heading">¶</a></h1>
<p>Above all, we need graphviz package. You can also refer to graphviz <a class="reference external" href="https://graphviz.readthedocs.io/en/stable/manual.html">documentation</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>-U<span class="w"> </span>graphviz
</pre></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.models</span> <span class="kn">import</span> <span class="n">yolov5s</span>
<span class="kn">from</span> <span class="nn">yolort.relay</span> <span class="kn">import</span> <span class="n">get_trace_module</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">yolov5s</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">tracing_module</span> <span class="o">=</span> <span class="n">get_trace_module</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/usr/local/lib/python3.9/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.datamodule` property is deprecated in v1.3 and will be removed in v1.5. Access the datamodule through using `self.trainer.datamodule` instead.
  if hasattr(mod, name):
/usr/local/lib/python3.9/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.loaded_optimizer_states_dict` property is deprecated in v1.4 and will be removed in v1.6.
  if hasattr(mod, name):
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/yolo_module.py:97: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  for img in inputs:
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/transform.py:79: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  images = [img for img in images]
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/anchor_utils.py:31: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  stride = torch.as_tensor([stride], dtype=dtype, device=device)
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/anchor_utils.py:50: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  anchor_grid = torch.as_tensor(anchor_grid, dtype=dtype, device=device)
/usr/local/lib/python3.9/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/anchor_utils.py:79: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  shifts = shifts - torch.tensor(0.5, dtype=shifts.dtype, device=device)
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/transform.py:312: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  torch.tensor(s, dtype=torch.float32, device=boxes.device)
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/transform.py:312: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  torch.tensor(s, dtype=torch.float32, device=boxes.device)
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/transform.py:313: TracerWarning: torch.tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  / torch.tensor(s_orig, dtype=torch.float32, device=boxes.device)
/Users/chi/Documents/projects/coding/yolov5-rt-stack/yolort/models/transform.py:313: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  / torch.tensor(s_orig, dtype=torch.float32, device=boxes.device)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tracing_module</span><span class="o">.</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
def forward(self,
    x: Tensor) -&gt; Tuple[Tensor, Tensor, Tensor]:
  model = self.model
  _0, _1, _2, = (model).forward(x, )
  return (_0, _1, _2)

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.relay.ir_visualizer</span> <span class="kn">import</span> <span class="n">TorchScriptVisualizer</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">visualizer</span> <span class="o">=</span> <span class="n">TorchScriptVisualizer</span><span class="p">(</span><span class="n">tracing_module</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dot1</span> <span class="o">=</span> <span class="n">visualizer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">classes_to_visit</span><span class="o">=</span><span class="p">{</span><span class="s1">'YOLO'</span><span class="p">,</span> <span class="s1">'YOLOHead'</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dot1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_model-graph-visualization_9_0.svg" src="../_images/notebooks_model-graph-visualization_9_0.svg"/></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dot2</span> <span class="o">=</span> <span class="n">visualizer</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">classes_to_visit</span><span class="o">=</span><span class="p">{</span><span class="s1">'YOLO'</span><span class="p">,</span> <span class="s1">'PostProcess'</span><span class="p">})</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dot2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_model-graph-visualization_11_0.svg" src="../_images/notebooks_model-graph-visualization_11_0.svg"/></div>
</div>
</section>
<p>View this document as a notebook:
<a class="reference external" href="https://github.com/zhiqwang/yolov5-rt-stack/blob/main/notebooks/model-graph-visualization.ipynb">https://github.com/zhiqwang/yolov5-rt-stack/blob/main/notebooks/model-graph-visualization.ipynb</a></p>
<hr class="docutils"/>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="anchor-label-assignment-visualization.html" title="Visualize the anchor-target assignment"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Visualize the anchor-target assignment </span>
              </div>
            </a>
          
          
            <a href="export-onnx-inference-onnxruntime.html" title="Deploying yolort on ONNX Runtime"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Deploying yolort on ONNX Runtime </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2023, yolort team.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 7.1.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>