
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  
  
    <title>Deploying yolort on TVM &#8212; yolort  documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/material.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="../_static/mathjax/tex-chtml.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.svg"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="yolort.models" href="../models.html" />
    <link rel="prev" title="Deploying yolort on TensorRT" href="onnx-graphsurgeon-inference-tensorrt.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=blue data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#notebooks/export-relay-inference-tvm" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="yolort  documentation"
           class="md-header-nav__button md-logo">
          
              <img src="../_static/yolort_logo_icon.png" height="26"
                   alt="yolort documentation logo">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">YOLOv5 Runtime Stack</span>
          <span class="md-header-nav__topic"> Deploying yolort on TVM </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/zhiqwang/yolov5-rt-stack/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">yolort  documentation</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="yolort documentation" class="md-nav__button md-logo">
      
        <img src="../_static/yolort_logo_icon.png" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="yolort documentation">YOLOv5 Runtime Stack</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/zhiqwang/yolov5-rt-stack/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    yolort
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Getting Started</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../installation.html" class="md-nav__link">Install yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Tutorials</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="inference-pytorch-export-libtorch.html" class="md-nav__link">Intuition for yolort</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="comparison-between-yolort-vs-yolov5.html" class="md-nav__link">What is the difference between yolort and yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="how-to-align-with-ultralytics-yolov5.html" class="md-nav__link">How to align with ultralytics yolov5</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="anchor-label-assignment-visualization.html" class="md-nav__link">Visualize the anchor-target assignment</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="model-graph-visualization.html" class="md-nav__link">Visualize model graph</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Deployment</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="export-onnx-inference-onnxruntime.html" class="md-nav__link">Deploying yolort on ONNX Runtime</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="onnx-graphsurgeon-inference-tensorrt.html" class="md-nav__link">Deploying yolort on TensorRT</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Deploying yolort on TVM </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Deploying yolort on TVM</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#notebooks-export-relay-inference-tvm--page-root" class="md-nav__link">Deploying yolort on TVM</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Load-pre-trained-yolov5n-from-yolort-and-do-tracing" class="md-nav__link">Load pre-trained <code class="docutils literal notranslate"><span class="pre">yolov5n</span></code> from yolort and do tracing</a>
        </li>
        <li class="md-nav__item"><a href="#Download-a-test-image-and-pre-process" class="md-nav__link">Download a test image and pre-process</a>
        </li>
        <li class="md-nav__item"><a href="#Import-the-graph-to-Relay" class="md-nav__link">Import the graph to Relay</a>
        </li>
        <li class="md-nav__item"><a href="#Compile-with-Relay-VM" class="md-nav__link">Compile with Relay VM</a>
        </li>
        <li class="md-nav__item"><a href="#Inference-with-Relay-VM" class="md-nav__link">Inference with Relay VM</a>
        </li>
        <li class="md-nav__item"><a href="#Get-boxes-with-score-larger-than-0.6" class="md-nav__link">Get boxes with score larger than 0.6</a>
        </li>
        <li class="md-nav__item"><a href="#Verify-the-Inference-Output-on-TVM-backend" class="md-nav__link">Verify the Inference Output on TVM backend</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">API Reference</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html" class="md-nav__link">yolort.models</a>
      <ul class="md-nav__list"> 
    <li class="md-nav__item">
    
    
      <a href="../models.html#models-structure" class="md-nav__link">Models structure</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../models.html#pre-trained-weights" class="md-nav__link">Pre-trained weights</a>
      
    
    </li></ul>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../yolov5.html" class="md-nav__link">Modules and utils for YOLOv5</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#notebooks-export-relay-inference-tvm--page-root" class="md-nav__link">Deploying yolort on TVM</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#Load-pre-trained-yolov5n-from-yolort-and-do-tracing" class="md-nav__link">Load pre-trained <code class="docutils literal notranslate"><span class="pre">yolov5n</span></code> from yolort and do tracing</a>
        </li>
        <li class="md-nav__item"><a href="#Download-a-test-image-and-pre-process" class="md-nav__link">Download a test image and pre-process</a>
        </li>
        <li class="md-nav__item"><a href="#Import-the-graph-to-Relay" class="md-nav__link">Import the graph to Relay</a>
        </li>
        <li class="md-nav__item"><a href="#Compile-with-Relay-VM" class="md-nav__link">Compile with Relay VM</a>
        </li>
        <li class="md-nav__item"><a href="#Inference-with-Relay-VM" class="md-nav__link">Inference with Relay VM</a>
        </li>
        <li class="md-nav__item"><a href="#Get-boxes-with-score-larger-than-0.6" class="md-nav__link">Get boxes with score larger than 0.6</a>
        </li>
        <li class="md-nav__item"><a href="#Verify-the-Inference-Output-on-TVM-backend" class="md-nav__link">Verify the Inference Output on TVM backend</a>
        </li></ul>
            </nav>
        </li>
  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<style>
    .nbinput .prompt,
    .nboutput .prompt {
        display: none;
    }
</style><section id="Deploying-yolort-on-TVM">
<h1 id="notebooks-export-relay-inference-tvm--page-root">Deploying yolort on TVM<a class="headerlink" href="#notebooks-export-relay-inference-tvm--page-root" title="Permalink to this headline">¶</a></h1>
<p>This article is an introductory tutorial to deploy PyTorch YOLOv5 models with Relay VM.</p>
<p>For us to begin with, PyTorch should be installed. TorchVision is also required since we will be using it as our model zoo.</p>
<p>A quick solution is to install via pip</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>pip install <span class="nv">torch</span><span class="o">==</span><span class="m">1</span>.10.1
pip install <span class="nv">torchvision</span><span class="o">==</span><span class="m">0</span>.11.2
</pre></div>
</div>
<p>or please refer to official site <a class="reference external" href="https://pytorch.org/get-started/locally/">https://pytorch.org/get-started/locally/</a></p>
<p>PyTorch versions should be backwards compatible but should be used with the proper TorchVision version.</p>
<p>Currently, Only test <code class="docutils literal notranslate"><span class="pre">TVM</span></code> with PyTorch 1.7.x and 1.10.x, other versions may be unstable.</p>
<p>And this notebook is running on macOS M1.</p>
<hr class="docutils"/>
<p>Copyright © Most of the codes is copied from the <a class="reference external" href="https://tvm.apache.org/docs/tutorials/frontend/deploy_object_detection_pytorch.html#sphx-glr-tutorials-frontend-deploy-object-detection-pytorch-py">TVM tutorial</a>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tvm</span>
<span class="kn">from</span> <span class="nn">tvm</span> <span class="kn">import</span> <span class="n">relay</span>
<span class="kn">from</span> <span class="nn">tvm.runtime.vm</span> <span class="kn">import</span> <span class="n">VirtualMachine</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cv2</span>

<span class="c1"># PyTorch imports</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="kn">import</span> <span class="nn">torchvision</span>
</pre></div>
</div>
</div>
<section id="Load-pre-trained-yolov5n-from-yolort-and-do-tracing">
<h2 id="Load-pre-trained-yolov5n-from-yolort-and-do-tracing">Load pre-trained <code class="docutils literal notranslate"><span class="pre">yolov5n</span></code> from yolort and do tracing<a class="headerlink" href="#Load-pre-trained-yolov5n-from-yolort-and-do-tracing" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">in_size</span> <span class="o">=</span> <span class="mi">640</span>
<span class="n">input_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="n">in_size</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.models</span> <span class="kn">import</span> <span class="n">yolov5n</span>
<span class="kn">from</span> <span class="nn">yolort.relay</span> <span class="kn">import</span> <span class="n">get_trace_module</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_func</span> <span class="o">=</span> <span class="n">yolov5n</span><span class="p">(</span><span class="n">pretrained</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="n">in_size</span><span class="p">))</span>
<span class="n">script_module</span> <span class="o">=</span> <span class="n">get_trace_module</span><span class="p">(</span><span class="n">model_func</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="n">input_shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.loaded_optimizer_states_dict` property is deprecated in v1.4 and will be removed in v1.6.
  if hasattr(mod, name):
/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:668: LightningDeprecationWarning: The `LightningModule.model_size` property was deprecated in v1.5 and will be removed in v1.7. Please use the `pytorch_lightning.utilities.memory.get_model_size_mb`.
  if hasattr(mod, name):
/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/_jit_internal.py:669: LightningDeprecationWarning: The `LightningModule.model_size` property was deprecated in v1.5 and will be removed in v1.7. Please use the `pytorch_lightning.utilities.memory.get_model_size_mb`.
  item = getattr(mod, name)
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/yolo_module.py:113: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  for img in inputs:
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/transform.py:179: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  images = [img for img in images]
/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/nn/functional.py:3701: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  (torch.floor((input.size(i + 2).float() * torch.tensor(scale_factors[i], dtype=torch.float32)).float()))
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/transform.py:282: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  img_h, img_w = _get_shape_onnx(img)
/Users/zhiqiang/miniconda3/envs/tvm/lib/python3.8/site-packages/torch/functional.py:445: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at  ../aten/src/ATen/native/TensorShape.cpp:2157.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/anchor_utils.py:45: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  anchors = torch.as_tensor(self.anchor_grids, dtype=torch.float32, device=device).to(dtype=dtype)
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/anchor_utils.py:46: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/box_head.py:402: TracerWarning: torch.as_tensor results are registered as constants in the trace. You can safely ignore this warning if you use this function to create tensors out of constant variables that would be the same every time you call this function. In any other case, this might cause the trace to be incorrect.
  strides = torch.as_tensor(self.strides, dtype=torch.float32, device=device).to(dtype=dtype)
/Users/zhiqiang/Coding/yolov5-rt-stack/yolort/models/box_head.py:333: TracerWarning: Iterating over a tensor might cause the trace to be incorrect. Passing a tensor of different shape won't change the number of iterations executed (and might lead to errors or silently give incorrect results).
  for head_output, grid, shift, stride in zip(head_outputs, grids, shifts, strides):
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">script_module</span><span class="o">.</span><span class="n">graph</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
graph(%self.1 : __torch__.yolort.relay.trace_wrapper.TraceWrapper,
      %x : Float(1, 3, 640, 640, strides=[1228800, 409600, 640, 1], requires_grad=0, device=cpu)):
  %model : __torch__.yolort.models.yolo_module.YOLOv5 = prim::GetAttr[name="model"](%self.1)
  %4973 : (Tensor, Tensor, Tensor) = prim::CallMethod[name="forward"](%model, %x)
  %4970 : Float(0, 4, strides=[4, 1], requires_grad=0, device=cpu), %4971 : Float(0, strides=[1], requires_grad=0, device=cpu), %4972 : Long(0, strides=[1], requires_grad=0, device=cpu) = prim::TupleUnpack(%4973)
  %3751 : (Float(0, 4, strides=[4, 1], requires_grad=0, device=cpu), Float(0, strides=[1], requires_grad=0, device=cpu), Long(0, strides=[1], requires_grad=0, device=cpu)) = prim::TupleConstruct(%4970, %4971, %4972)
  return (%3751)
</pre></div></div>
</div>
</section>
<section id="Download-a-test-image-and-pre-process">
<h2 id="Download-a-test-image-and-pre-process">Download a test image and pre-process<a class="headerlink" href="#Download-a-test-image-and-pre-process" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">yolort.utils</span> <span class="kn">import</span> <span class="n">get_image_from_url</span>

<span class="n">img_source</span> <span class="o">=</span> <span class="s2">"https://huggingface.co/spaces/zhiqwang/assets/resolve/main/bus.jpg"</span>
<span class="c1"># img_source = "https://huggingface.co/spaces/zhiqwang/assets/resolve/main/zidane.jpg"</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">get_image_from_url</span><span class="p">(</span><span class="n">img_source</span><span class="p">)</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">"float32"</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">cv2</span><span class="o">.</span><span class="n">resize</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="p">(</span><span class="n">in_size</span><span class="p">,</span> <span class="n">in_size</span><span class="p">))</span>

<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">img</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Import-the-graph-to-Relay">
<h2 id="Import-the-graph-to-Relay">Import the graph to Relay<a class="headerlink" href="#Import-the-graph-to-Relay" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">input_name</span> <span class="o">=</span> <span class="s2">"input0"</span>
<span class="n">shape_list</span> <span class="o">=</span> <span class="p">[(</span><span class="n">input_name</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="o">*</span><span class="n">input_shape</span><span class="p">))]</span>
<span class="n">mod</span><span class="p">,</span> <span class="n">params</span> <span class="o">=</span> <span class="n">relay</span><span class="o">.</span><span class="n">frontend</span><span class="o">.</span><span class="n">from_pytorch</span><span class="p">(</span><span class="n">script_module</span><span class="p">,</span> <span class="n">shape_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using reduce.cpu for min based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for minimum based on highest priority (10)
Using injective.cpu for floor based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using reduce.cpu for min based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for minimum based on highest priority (10)
Using injective.cpu for floor based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for ceil based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for round based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for ceil based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for round based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for ceil based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for round based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for ceil based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for round based on highest priority (10)
</pre></div></div>
</div>
</section>
<section id="Compile-with-Relay-VM">
<h2 id="Compile-with-Relay-VM">Compile with Relay VM<a class="headerlink" href="#Compile-with-Relay-VM" title="Permalink to this headline">¶</a></h2>
<p>Note: Currently only CPU target is supported. For x86 target, it is highly recommended to build TVM with Intel MKL and Intel OpenMP to get best performance, due to the existence of large dense operator in torchvision rcnn models.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add "-libs=mkl" to get best performance on x86 target.</span>
<span class="c1"># For x86 machine supports AVX512, the complete target is</span>
<span class="c1"># "llvm -mcpu=skylake-avx512 -libs=mkl"</span>
<span class="n">target</span> <span class="o">=</span> <span class="s2">"llvm"</span>

<span class="k">with</span> <span class="n">tvm</span><span class="o">.</span><span class="n">transform</span><span class="o">.</span><span class="n">PassContext</span><span class="p">(</span><span class="n">opt_level</span><span class="o">=</span><span class="mi">3</span><span class="p">):</span>
    <span class="n">vm_exec</span> <span class="o">=</span> <span class="n">relay</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="n">target</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">params</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sqrt based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for negative based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for arange based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for meshgrid based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for copy based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for arange based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for meshgrid based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for copy based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for arange based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for meshgrid based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for copy based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for repeat based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for less based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for minimum based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
One or more operators have not been tuned. Please tune your model for better performance. Use DEBUG logging level to see more details.
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using conv2d_nchw.x86 for nn.conv2d based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for image.resize2d based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using pool.cpu for nn.max_pool2d based on highest priority (10)
Using pool.cpu for nn.max_pool2d based on highest priority (10)
Using pool.cpu for nn.max_pool2d based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for image.resize2d based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for image.resize2d based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using conv2d_NCHWc.x86 for nn.contrib_conv2d_NCHWc based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using transpose.generic for transpose based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for power based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using transpose.generic for transpose based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for power based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using injective.cpu for layout_transform based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using transpose.generic for transpose based on highest priority (10)
Using injective.cpu for sigmoid based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for power based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for reshape based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for take based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for greater based on highest priority (10)
Using argwhere.generic for argwhere based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for adv_index based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for adv_index based on highest priority (10)
Using injective.cpu for ndarray_size based on highest priority (10)
Using injective.cpu for equal based on highest priority (10)
Using injective.cpu for zeros based on highest priority (10)
Using reduce.cpu for min based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using reduce.cpu for max based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using concatenate.cpu for concatenate based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using injective.cpu for shape_of based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for arange based on highest priority (10)
Using injective.cpu for expand_dims based on highest priority (10)
Using nms.generic for vision.non_max_suppression based on highest priority (10)
[12:46:54] /Users/zhiqiang/Coding/tvm/src/te/schedule/bound.cc:119: not in feed graph consumer = hybrid(hybrid_nms, 0x60000a817250)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for shape_of based on highest priority (10)
Using injective.cpu for slice_like based on highest priority (10)
Using injective.cpu for where based on highest priority (10)
Using injective.cpu for greater_equal based on highest priority (10)
Using injective.cpu for where based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for dyn.strided_slice based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for strided_slice based on highest priority (10)
Using injective.cpu for adv_index based on highest priority (10)
Using injective.cpu for split based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for squeeze based on highest priority (10)
Using injective.cpu for subtract based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for stack based on highest priority (10)
Using injective.cpu for adv_index based on highest priority (10)
Using injective.cpu for adv_index based on highest priority (10)
[12:46:54] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for cast based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using injective.cpu for add based on highest priority (10)
Using injective.cpu for divide based on highest priority (10)
Using reduce.cpu for prod based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using reduce.cpu for prod based on highest priority (10)
Using injective.cpu for multiply based on highest priority (10)
Using reduce.cpu for prod based on highest priority (10)
[12:46:55] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used
[12:46:55] /Users/zhiqiang/Coding/tvm/src/relay/transforms/let_list.h:54: Warning: letlist not used
</pre></div></div>
</div>
</section>
<section id="Inference-with-Relay-VM">
<h2 id="Inference-with-Relay-VM">Inference with Relay VM<a class="headerlink" href="#Inference-with-Relay-VM" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ctx</span> <span class="o">=</span> <span class="n">tvm</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span>
<span class="n">vm</span> <span class="o">=</span> <span class="n">VirtualMachine</span><span class="p">(</span><span class="n">vm_exec</span><span class="p">,</span> <span class="n">ctx</span><span class="p">)</span>
<span class="n">vm</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="s2">"main"</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">img</span><span class="p">})</span>
<span class="n">tvm_res</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>it
<span class="n">vm</span><span class="o">.</span><span class="n">set_input</span><span class="p">(</span><span class="s2">"main"</span><span class="p">,</span> <span class="o">**</span><span class="p">{</span><span class="n">input_name</span><span class="p">:</span> <span class="n">img</span><span class="p">})</span>
<span class="n">tvm_res</span> <span class="o">=</span> <span class="n">vm</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
65.2 ms ± 1.31 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)
</pre></div></div>
</div>
</section>
<section id="Get-boxes-with-score-larger-than-0.6">
<h2 id="Get-boxes-with-score-larger-than-0.6">Get boxes with score larger than 0.6<a class="headerlink" href="#Get-boxes-with-score-larger-than-0.6" title="Permalink to this headline">¶</a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">score_threshold</span> <span class="o">=</span> <span class="mf">0.6</span>
<span class="n">boxes</span> <span class="o">=</span> <span class="n">tvm_res</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">valid_boxes</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">score</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tvm_res</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span><span class="o">.</span><span class="n">tolist</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">score</span> <span class="o">&gt;</span> <span class="n">score_threshold</span><span class="p">:</span>
        <span class="n">valid_boxes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">boxes</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">break</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Get </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">valid_boxes</span><span class="p">)</span><span class="si">}</span><span class="s2"> valid boxes"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Get 4 valid boxes
</pre></div></div>
</div>
</section>
<section id="Verify-the-Inference-Output-on-TVM-backend">
<h2 id="Verify-the-Inference-Output-on-TVM-backend">Verify the Inference Output on TVM backend<a class="headerlink" href="#Verify-the-Inference-Output-on-TVM-backend" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">torch_res</span> <span class="o">=</span> <span class="n">script_module</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">torch_res</span><span class="p">)):</span>
    <span class="n">torch</span><span class="o">.</span><span class="n">testing</span><span class="o">.</span><span class="n">assert_allclose</span><span class="p">(</span><span class="n">torch_res</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">tvm_res</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">rtol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">"Exported model has been tested with TVM Runtime, and the result looks good!"</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Exported model has been tested with TVM Runtime, and the result looks good!
</pre></div></div>
</div>
</section>
</section>
<p>View this document as a notebook:
<a class="reference external" href="https://github.com/zhiqwang/yolov5-rt-stack/blob/main/notebooks/export-relay-inference-tvm.ipynb">https://github.com/zhiqwang/yolov5-rt-stack/blob/main/notebooks/export-relay-inference-tvm.ipynb</a></p>
<hr class="docutils"/>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="onnx-graphsurgeon-inference-tensorrt.html" title="Deploying yolort on TensorRT"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Deploying yolort on TensorRT </span>
              </div>
            </a>
          
          
            <a href="../models.html" title="yolort.models"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> yolort.models </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2022, yolort team.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 4.4.0.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>